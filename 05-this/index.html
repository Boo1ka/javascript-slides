<!doctype html>
<html lang="ru">

<head>
    <meta charset="utf-8">

    <title>JavaScript, this</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="../css/reveal.css">
    <link rel="stylesheet" href="../css/theme/yandex.css" id="theme">
    <link rel="stylesheet" href="css/user.css">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="../lib/css/zenburn.css">

    <!--[if lt IE 9]>
    <script src="../lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body class="yandex"><div class="reveal"><div class="slides">
<section class="large">
    <h1>this</h1>
    <h4>Контекст исполнения</h4>
    <p class="author"><small>Жигалов Сергей</small></p>
</section>

<section>
    <section>
        <h4><span class="grey">this</span> C++</h4>

        <pre class="cpp"><code data-trim>
class User {
public:
    int age=30;

    void showAge() {
        std::cout << this->age;
    };
};

int main() {
    User* sergey = new User;

    sergey->showAge(); // 30
}
        </code></pre>
    </section>

    <section>
        <h4><span class="grey">this</span> Java</h4>

        <pre class="java"><code data-trim>
public class User {
    private int age = 30;

    public void showAge() {
        System.out.println(this.age);
    }
}

public static void main(String []args){
    User sergey = new User();

    sergey.showAge();
}
        </code></pre>
    </section>

    <section>
        <h4><span class="grey">this</span> JavaScript</h4>

        <pre class="js"><code data-trim>
function User () {
    return {
        age: 30,

        showAge: function () {
            console.log(this.age);
        }
    }
}

var sergey = new User();

sergey.showAge();
        </code></pre>
    </section>

    <section>
        <h4>Свойства this</h4>

        <ul>
            <li>ключевое слово</li>
            <li>указывает на текущий объект</li>
            <li>нельзя перезаписать</li>
            <li>можно использовать за пределом объекта*</li>
        </ul>
    </section>

    <section>
        <h4><span class="grey">this</span> за пределом объекта</h4>

        <pre class="js"><code data-trim>
this.innerWidth; // 300
        </code></pre>

        <pre class="js"><code data-trim>
this.process.version; // v7.0.0
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>Контекст исполнения</h3>
    </section>

    <section>
        <div class="code-container">
        <pre class="js code"><code>
function sum(a, b) {
    return a + b;
}

sum (1, 2); </code></pre>
        <pre class="js lexical-envorinment fragment"><code data-trim>
┌{ sum } // 1
├─┬{ a, b } // 2
│ │
│ │
│
│
        </code></pre>
        </div>
    </section>

    <section data-transition="slide-in">
        <div class="code-container">
        <pre class="js code"><code>
function sum(a, b) {
    return a + b;
}

sum (1, 2); </code></pre>
        <pre class="js execution-context"><code data-trim>
┌{ lE: { sum }            }
├─┬{ lE: { a, b}            }
│ │
│ │
│
│
        </code></pre>
        </div>
    </section>

    <section data-transition="slide-out">
        <div class="code-container">
        <pre class="js code"><code>
function sum(a, b) {
    return a + b;
}

sum (1, 2); </code></pre>
        <pre class="js execution-context"><code data-trim>
┌{ lE: { sum }, this: ... }
├─┬{ lE: { a, b}, this: ... }
│ │
│ │
│
│
        </code></pre>
        </div>
    </section>
</section>

<section>
    <h4>Значение this зависит от:</h4>

    <ul class="no-bullet">
        <li>I. Типа участка кода</li>
        <li>II. Как мы попали на этот участок</li>
        <li>III. Режима работы интерпретатора</li>
    </ul>
</section>

<section>
    <section>
        <h4><span class="grey">I. Тип участка кода.</span> Глобальный</h4>

        <pre class="js size-S"><code data-trim>
this.innerWidth; // 1280
        </code></pre>

        <pre class="js size-S fragment"><code data-trim>
window.innerWidth; // 1280
        </code></pre>

        <pre class="js size-S fragment"><code data-trim>
innerWidth; // 1280
        </code></pre>
    </section>

    <section>
        <h4><span class="grey">I. Тип участка кода.</span> Глобальный</h4>

        <pre class="js size-S"><code data-trim>
this.process.version; // "v7.0.0"
        </code></pre>

        <pre class="js size-S fragment"><code data-trim>
global.process.version; // "v7.0.0"
        </code></pre>

        <pre class="js size-S fragment"><code data-trim>
process.version; // "v7.0.0"
        </code></pre>
    </section>

    <section>
        <h4><span class="grey">I. Тип участка кода.</span> Глобальный</h4>

        <pre class="js size-S"><code data-trim>
console.log('Hello!');
        </code></pre>

        <pre class="js size-S fragment"><code data-trim>
global.console.log('Hello!');
        </code></pre>

        <pre class="js size-S fragment"><code data-trim>
this.console.log('Hello!');
        </code></pre>
    </section>

    <section>
        <h4><span class="grey">I. Тип участка кода.</span> Глобальный</h4>

        <pre class="js size-S"><code data-trim>
this === global;
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h4><span class="grey">I. Тип участка кода.</span> Node.js модуль</h4>

        <pre class="js"><code data-trim>
// year-2016.js

module.exports.days = 366;
        </code></pre>

        <pre class="js fragment"><code data-trim>
this.isLeapYear = true;
        </code></pre>
    </section>

    <section>
        <h4><span class="grey">I. Тип участка кода.</span> Node.js модуль</h4>

        <pre class="js"><code data-trim>
// index.js

var year2016 = require('./year-2016');

year2016.days; // 366;
year2016.isLeapYear; // true;
        </code></pre>
    </section>
</section>

<section>
    <section>
        <h3>Строгий режим</h3>
    </section>

    <section>
        <h4>Строгий режим</h4>

        <pre class="js"><code data-trim>
'use strict';

function sum(a, b) {
    return a + b;
}
        </code></pre>
    </section>

    <section>
        <h4>Строгий режим</h4>

        <pre class="js"><code data-trim>
function sum(a, b) {
    'use strict';

    return a + b;
}
        </code></pre>
    </section>

    <section>
        <h4>Строгий режим</h4>

        <pre class="js"><code data-trim>
function func() {
    var eval = 42; // OK
}

function strictFunc() {
    'use strict';

    var eval = 42; // SyntaxError
}
        </code></pre>
    </section>

    <section>
        <h4>Строгий режим</h4>

        <pre class="js"><code data-trim>
function func() {
    randomNumber = 4; // OK
}

function strictFunc() {
    'use strict';

    randomNumber = 4; // ReferenceError
}
        </code></pre>
    </section>
</section>

</div></div>

<script src="../lib/js/head.min.js"></script>
<script src="../js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: false,
        progress: true,
        slideNumber: true,
        history: true,
        center: true,
        hideAddressBar: true,
        transition: 'slide', // none/fade/slide/convex/concave/zoom

        // Optional reveal.js plugins
        dependencies: [
            {
                src: '../plugin/highlight/highlight.js',
                async: true,
                condition: function () {
                    return !!document.querySelector('pre code');
                },
                callback: function () {
                    hljs.initHighlightingOnLoad();
                }
            }
        ]
    });

</script>

</body>
</html>
